<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Thank You - SÃ©rac</title>

  <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@300;400;500&family=Playfair+Display:wght@400;700&display=swap" rel="stylesheet" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" />

<style>
/* ================= RESET & BASE ================= */
* { margin:0; padding:0; box-sizing:border-box; }
html, body { font-family:"Montserrat", sans-serif; color:#F5F5F3; background:#141517; scroll-behavior:smooth; }
a { text-decoration:none; color: inherit; transition: color 0.3s ease; }
a:hover { color:#B66E41; }

/* ================= HEADER ================= */
.site-header {
  position: fixed;
  top:0; left:0; right:0;
  display:flex;
  justify-content:space-between;
  align-items:center;
  padding:16px 28px;
  background: transparent;
  border-bottom:1px solid rgba(245,245,243,0.1);
  transition: background 0.4s ease, box-shadow 0.4s ease;
  z-index:1200;
}
.site-header.scrolled { background: rgba(20,21,23,0.95); box-shadow:0 4px 20px rgba(0,0,0,0.6); }

.header-left { display:flex; align-items:center; gap:12px; }
.brand-logo { height:70px; }
.brand-title { font-family:"Playfair Display", serif; font-size:28px; font-weight:700; color:#B66E41; }

.header-right {
  display:flex;
  gap:28px;
  font-weight:500;
}
.header-right a {
  position: relative;
  color: #F5F5F3;
  padding: 6px 0;
  font-size: 1rem;
}
.header-right a::after {
  content:"";
  position:absolute;
  bottom:-4px;
  left:0;
  width:0;
  height:2px;
  background:#B66E41;
  transition: width 0.3s ease;
}
.header-right a:hover {
  color: #B66E41;;
}

.header-right a:hover::after { width:100%; }

/* ================= HAMBURGER ================= */
.hamburger {
  display:none;
  background:none;
  border:none;
  width:30px;
  height:24px;
  position:relative;
  cursor:pointer;
  z-index:1300;
}
.hamburger span {
  display:block;
  width:100%;
  height:3px;
  background:#B66E41;
  border-radius:2px;
  position:absolute;
  left:0;
  transition:0.3s;
}
.hamburger span:nth-child(1){ top:0; }
.hamburger span:nth-child(2){ top:10px; }
.hamburger span:nth-child(3){ top:20px; }
.hamburger.open span:nth-child(1){ transform:rotate(45deg); top:10px; }
.hamburger.open span:nth-child(2){ opacity:0; }
.hamburger.open span:nth-child(3){ transform:rotate(-45deg); top:10px; }

/* ================= HERO ================= */
.hero {
  position: relative;
  height: 95vh;
  display: flex;
  justify-content: center;
  align-items: center;
  text-align: center;
  margin-top: 0;
  overflow: hidden;
  background: url("asset/bg25.jpg") center center / cover no-repeat;
}
.hero::after {
  content: "";
  position: absolute;
  top: 0; left: 0; right: 0; bottom: 0;
  background: rgba(20, 21, 23, 0.6);
  z-index: 1;
}
.hero-text {
  position: relative;
  z-index: 2;
  color: #B66E41;
}
.hero-text h1 {
  font-family: "Playfair Display", serif;
  font-size: clamp(36px, 5vw, 64px);
  margin-bottom: 12px;
}
.hero-text p {
  font-size: clamp(16px, 2vw, 22px);
  color: #eee;
}

/* ================= MAIN SECTION ================= */
.thankyou-section {
  min-height: 100vh;
  display: flex;
  justify-content: center;
  align-items: center;
  padding: 100px 20px;
}
.thankyou-box {
  max-width: 960px;
  width: 100%;
  background: #1c1e22;
  padding: 60px;
  border-radius: 16px;
  box-shadow: 0 12px 40px rgba(0,0,0,0.6);
  color: #ddd;
  text-align: center;
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
}
.thankyou-box h2 {
  font-family: "Playfair Display", serif;
  color: var(--gold);
  margin-bottom: 12px;
}
.thankyou-box p {
  color: #ccc;
  margin-bottom: 10px;
}
#orderReferenceBox {
  background: #17181b;
  padding: 14px 20px;
  border-radius: 10px;
  border: 1px solid rgba(255,255,255,0.04);
  font-weight: 600;
  font-size: 18px;
  color: #fff;
  margin: 14px 0;
  cursor: pointer;
  display: inline-block;
}
#orderReferenceNote {
  color: #999;
  font-size: 13px;
  margin-bottom: 12px;
}
.order-details {
  background: #17181b;
  padding: 20px;
  border-radius: 10px;
  text-align: center;
  border: 1px solid rgba(255,255,255,0.04);
}
.order-details h3 {
  color: var(--gold);
  text-align: center;
  font-family: "Playfair Display", serif;
  margin-bottom: 8px;
}
.order-details li {
  color: #eee;
  padding: 10px 0;
  text-align: left;
  list-style: none;
  border-bottom: 1px solid rgba(255,255,255,0.02);
}
.btn {
  display: inline-block;
  padding: 12px 26px;
  border-radius: 8px;
  font-weight: 600;
  cursor: pointer;
  margin-top: 12px;
}
.btn-primary {
  background: var(--gold);
  color: #fff;
  border: 0;
}
.btn-secondary {
  background: transparent;
  color: var(--gold);
  border: 2px solid var(--gold);
}

/* ================= OVERLAY & SPINNER ================= */
#serac-overlay {
  position: fixed;
  inset: 0;
  z-index: 9999;
  display: flex;
  align-items: center;
  justify-content: center;
  background: rgba(0,0,0,0.95);
  backdrop-filter: blur(6px);
  transition: opacity .45s ease;
}
.gold-spinner {
  width: 64px;
  height: 64px;
  border-radius: 50%;
  border: 5px solid rgba(182,110,65,0.18);
  border-top-color: #B66E41;
  animation: serac-spin 1s linear infinite;
  box-shadow: 0 6px 26px rgba(0,0,0,0.6);
}
@keyframes serac-spin {
  to { transform: rotate(360deg); }
}

/* ================= FLOATING SUPPORT BUTTON ================= */
#floatingSupportBtn {
  position: fixed;
  bottom: 25px;
  right: 25px;
  width: 56px;
  height: 56px;
  background: #1a202b;
  color: #fff;
  border: none;
  border-radius: 50%;
  cursor: pointer;
  font-size: 24px;
  display: flex;
  align-items: center;
  justify-content: center;
  box-shadow: 0 6px 20px rgba(182,110,65,1);
  transition: all 0.3s ease;
  z-index: 9999;
}
#floatingSupportBtn:hover {
  background: #20232b;
  transform: translateY(-2px);
  box-shadow: 0 8px 24px rgba(75,78,84,1.0);
}
.support-tooltip {
  position: absolute;
  bottom: 30px;
  left: 20%;
  transform: translateX(-50%);
  background: #1c1e22;
  color: #fff;
  padding: 6px 12px;
  border-radius: 8px;
  font-size: 14px;
  white-space: nowrap;
  opacity: 0;
  pointer-events: none;
  transition: opacity 0.3s ease, transform 0.3s ease;
}
#floatingSupportBtn:hover .support-tooltip {
  opacity: 1;
  transform: translateY(-50%) translateX(0);
}

/* ================= FOOTER ================= */
footer {
  text-align: center;
  padding: 28px;
  background: #141517;
  color: #aaa;
  margin-top: 60px;
}
footer p {
  font-size: 14px;
}

/* ================= RESPONSIVE ================= */
@media (max-width: 900px) {
  section.story .container { grid-template-columns: 1fr; gap: 30px; }
  .contact-flex { flex-direction: column; }
}
@media (max-width: 900px) {
  .header-right {
    display: none;
    flex-direction: column;
    background: #141517;
    position: absolute;
    top: 70px;
    right: 0;
    width: 220px;
    padding: 20px;
    border-radius: 0 0 0 12px;
  }
  .header-right.open { display: flex; }
  .hamburger { display: block; }
  .hero { height: 60vh; padding-top: 80px; }
  .hero-text h1 { font-size: 30px; }
  .hero-text p { font-size: 16px; }
}
</style>

<style>
@media(min-width: 200px) {
  .hero { position: relative; overflow: visible; }

  .hero-peek {
    position: absolute;
    bottom: -20px;
    left: 50%;
    transform: translateX(-50%);
    width: 90%;
    height: 20px;
    border-radius: 10px / 50%;
    z-index: 2;
    box-shadow: 0 -6px 15px rgba(0,0,0,0.15);
    animation: peekFloat 2s ease-in-out infinite alternate;
  }

  .hero-peek[data-theme="dark"] {
    background: linear-gradient(to top, rgba(182,110,65,0.3), transparent);
  }

  .hero-peek[data-theme="light"] {
    background: linear-gradient(to top, rgba(255,235,200,0.35), transparent);
  }

  @keyframes peekFloat {
    0% { transform: translateX(-50%) translateY(0); opacity: 0.85; }
    100% { transform: translateX(-50%) translateY(-4px); opacity: 1; }
  }
}
</style>

  

</head>
<body>
  <!-- Loader overlay -->
  <div id="serac-overlay" aria-hidden="true">
    <div class="gold-spinner" role="status" aria-label="Loading"></div>
  </div>

  <header class="site-header" id="siteHeader">
    <div class="header-left">
      <img src="asset/logo.png" alt="SÃ©rac" class="brand-logo" />
      <div class="brand-title">SÃ©rac</div>
    </div>

    <nav class="header-right" id="headerRight">
      <a href="index.html">Home</a>
      <a href="shop.html">Shop</a>
      <a href="about.html">About</a>
      <a href="contact.html">Contact</a>
      <a href="trackorder.html">Track</a>
    </nav>

    <button class="hamburger" id="hamburger" aria-label="Menu" aria-expanded="false">
      <span></span><span></span><span></span>
    </button>
  </header>

  <main>
   <section class="hero">
    <div class="hero-text">
      <h1>Thank You</h1>
      <p>For Trusting Us</p>
    </div>
    </section>

    <section class="thankyou-section">
      <div class="thankyou-box">
        <h2>Weâ€™ve received your order ðŸŽ‰</h2>
        <p>Thank you for shopping with <strong>SÃ©rac</strong>. Your order is now being processed.</p>

        <div id="orderReferenceBox">Loading referenceâ€¦</div>
        <div id="orderReferenceNote"></div>

        <div style="margin:14px 0;">
          <button id="sendEmailBtn" class="btn btn-secondary">Send to my email</button>
        </div>

        <div class="order-details" id="orderDetails">
          <p>Loading order detailsâ€¦</p>
        </div>

        <div style="margin-top:18px">
          <a href="shop.html" class="btn btn-primary">Continue Shopping</a>
          <a id="trackOrderBtn" href="trackorder.html" class="btn btn-secondary">Track Order</a>
        </div>
      </div>
    </section>
  </main>
  
    <!-- Floating Chat-Style Support Button -->
  <button id="floatingSupportBtn" aria-label="Contact Support">
    <i class="fas fa-headset"></i>
    <span class="support-tooltip">Support</span>
  </button>
  
  <footer>Â© 2025 SÃ©rac</footer>

  <script type="module">
    // ------------- UI behavior -------------
    const overlay = document.getElementById('serac-overlay');
    const header = document.getElementById('siteHeader');
    const hamburger = document.getElementById('hamburger');
    const headerRight = document.getElementById('headerRight');
    

    // ------------- Firestore imports -------------
    import { initializeApp } from "https://www.gstatic.com/firebasejs/10.3.1/firebase-app.js";
    import { getFirestore, doc, getDoc, collection, query, where, getDocs } from "https://www.gstatic.com/firebasejs/10.3.1/firebase-firestore.js";

    const firebaseConfig = {
      apiKey: "AIzaSyCuiZXHFYl1fVKnGwojavRvbekSBpkipJg",
      authDomain: "brandisby.firebaseapp.com",
      projectId: "brandisby",
      storageBucket: "brandisby.firebasestorage.app",
      messagingSenderId: "87213267039",
      appId: "1:87213267039:web:339e9fd49e3ad31f7423ea"
    };
    const app = initializeApp(firebaseConfig);
    const db = getFirestore(app);

    // ------------- Helpers -------------
    function safeParseJSON(v){ try{ return JSON.parse(v||'null'); } catch(e){ return null; } }

    function showCopyPopup(text){
      const pop = document.createElement('div');
      pop.textContent = text;
      Object.assign(pop.style, {
        position:'fixed',left:'50%',bottom:'36px',transform:'translateX(-50%)',
        background:'#B66E41',color:'#fff',padding:'10px 16px',borderRadius:'8px',zIndex:10000,opacity:'0',transition:'opacity .25s'
      });
      document.body.appendChild(pop);
      requestAnimationFrame(()=> pop.style.opacity='1');
      setTimeout(()=> { pop.style.opacity='0'; setTimeout(()=>pop.remove(),280); },1800);
    }

    // ------------- Main display logic -------------
    async function displayOrder(){
      const refBox = document.getElementById('orderReferenceBox');
      const note = document.getElementById('orderReferenceNote');
      const details = document.getElementById('orderDetails');
      const trackBtn = document.getElementById('trackOrderBtn');
      const sendEmail = document.getElementById('sendEmailBtn');

      // 1) Prefer local saved order from checkout flow
      let order = safeParseJSON(localStorage.getItem('lastOrder_serac'));

      // 2) Check URL params (orderId, txref, quoteId)
      const params = new URLSearchParams(window.location.search);
      const orderId = params.get('orderId');
      const txref = params.get('txref') || params.get('ref') || null;
      const quoteId = params.get('quoteId');

      // 3) If no local order, try to fetch by orderId
      if(!order && orderId){
        try{
          const snap = await getDoc(doc(db, "brands", "serac", "orders", orderId));
          if(snap.exists()){ order = snap.data(); order.id = orderId; }
        }catch(e){ console.error('fetch order by id failed', e); }
      }

      // 4) If txref present and still no order, try as doc id then by trackingRef field
      if(!order && txref){
        try{
          // attempt doc id first
          const snap = await getDoc(doc(db, "brands", "serac", "orders", txref));
          if(snap.exists()){
            order = snap.data();
            order.id = snap.id;
          } else {
            // query by trackingRef field
            const q = query(collection(db, "brands", "serac", "orders"), where("trackingRef", "==", txref));
            const snaps = await getDocs(q);
            if(!snaps.empty){
              const s = snaps.docs[0];
              order = s.data(); order.id = s.id;
            }
          }
        }catch(e){ console.error('fetch by txref failed', e); }
      }

      // 5) If still no order, check paidQuoteInfo and/or fetch quote doc
      if(!order && (quoteId || safeParseJSON(localStorage.getItem('paidQuoteInfo'))?.quoteId )){
        const qid = quoteId || safeParseJSON(localStorage.getItem('paidQuoteInfo'))?.quoteId;
        try{
          const qsnap = await getDoc(doc(db, "brands", "serac", "quotes", qid));
          if(qsnap.exists()){
            const qdata = qsnap.data();
            order = {
              id: qid,
              type: 'quote',
              trackingRef: qdata.trackingRef || qdata.orderRef || null,
              name: qdata.name || qdata.customer || qdata.customerName || '',
              email: qdata.email || '',
              phone: qdata.phone || '',
              address: qdata.address || '',
              currency: qdata.currency || 'NGN',
              total: qdata.total || qdata.amount || qdata.subtotal || 0,
              items: qdata.items || []
            };
          }
        }catch(e){ console.error('fetch quote failed', e); }
      }

      // 6) If still nothing â€” display message and remove overlay
      if(!order){
        refBox.textContent = 'No order reference available.';
        note.textContent = '';
        details.innerHTML = '<p>Unable to locate order details. If you just paid, please wait a few moments and refresh.</p>';
        sendEmail.style.display = 'none';
        trackBtn.style.display = 'none';
        fadeRemoveOverlay();
        return;
      }

      // Normalize order for UI usage
      const ref = order.trackingRef || order.tracking || order.orderRef || order.id || 'N/A';
      refBox.textContent = ref;
      note.textContent = 'You can use this reference to track your order.';

      // clicking copies reference
      refBox.onclick = async () => {
        try {
          await navigator.clipboard.writeText(ref);
          showCopyPopup('Copied!');
        } catch(e){ console.error('copy failed', e); }
      };

      // Render details
      const currency = order.currency || order.currencyCode || 'NGN';
      const total = order.total ?? order.amount ?? order.subtotal ?? '-';
      let html = `<h3>Order Details</h3><ul>`;
      html += `<li><strong>Name:</strong> ${escapeHtml(order.name || order.customer || '-')}</li>`;
      html += `<li><strong>Email:</strong> ${escapeHtml(order.email || '-')}</li>`;
      html += `<li><strong>Phone:</strong> ${escapeHtml(order.phone || '-')}</li>`;
      html += `<li><strong>Address:</strong> ${escapeHtml(order.address || '-')}</li>`;
      html += `<li><strong>Currency:</strong> ${escapeHtml(currency)}</li>`;
      html += `<li><strong>Total Paid:</strong> ${escapeHtml(currency)} ${escapeHtml(String(total))}</li>`;
      html += `</ul><h3>Items</h3><ul>`;
      (order.items || []).forEach(i=>{
        const name = i.name || i.productName || i.title || 'Item';
        const qty = i.quantity || i.qty || i.count || 1;
        html += `<li>${escapeHtml(name)} (x${escapeHtml(String(qty))})</li>`;
      });
      html += `</ul>`;
      details.innerHTML = html;

      // Send email button
      sendEmail.onclick = () => {
        const subject = encodeURIComponent('Your SÃ©rac Order Confirmation');
        const body = encodeURIComponent(`Hello ${order.name || ''},

Thank you for shopping with SÃ©rac.

Order reference: ${ref}
Total: ${currency} ${total}

Track here: ${window.location.origin}/trackorder.html

Regards,
SÃ©rac`);
        window.location.href = `mailto:${order.email || ''}?subject=${subject}&body=${body}`;
      };

      // Track button simply goes to trackorder.html
      trackBtn.href = 'trackorder.html';

      // cleanup saved local copies (if any)
      try{ localStorage.removeItem('lastOrder_serac'); localStorage.removeItem('paidQuoteInfo'); }catch(e){}

      // done -> fade overlay after small delay to make transition premium
      setTimeout(fadeRemoveOverlay, 500);
    }

    // small helper to safely escape text for insertion
    function escapeHtml(s){
      if(s === undefined || s === null) return '';
      return String(s).replace(/[&<>"']/g, ch => ({'&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;',"'":"&#39;"}[ch]));
    }

    function fadeRemoveOverlay(){
      if(!overlay) return;
      overlay.style.opacity = '0';
      setTimeout(()=>{ overlay.remove?.() }, 600);
    }

    // Start after DOM ready
    document.addEventListener('DOMContentLoaded', () => {
      // Ensure overlay is visible until finish
      try{ overlay.style.opacity = '1'; } catch(e){}
      displayOrder().catch(err => {
        console.error('displayOrder error', err);
        fadeRemoveOverlay();
      });
    });

    const supportBtn = document.getElementById('floatingSupportBtn');
  supportBtn.addEventListener('click', () => {
    window.location.href = 'mailto:stonecold.serac@gmail.com?subject=Support%20Request';
  });



/* -------------------- HEADER/HERO BEHAVIOR (darken immediately; hide after hero) -------------------- */
(function headerHeroBehavior(){
  const headerEl = document.querySelector('.site-header') || document.getElementById('siteHeader');
  const heroEl = document.querySelector('.hero') || document.getElementById('heroSection') || document.querySelector('.hero-about');
  const hamburger = document.getElementById('hamburger');
  const headerRight = document.querySelector('.header-right');

  if (!headerEl || !heroEl) return;

  let lastY = window.scrollY || 0;
  let hidden = false;
  let hoverShown = false;
  let heroHeight = Math.round(heroEl.getBoundingClientRect().height);

  function isMenuOpen() {
    return hamburger && hamburger.classList.contains('open');
  }

  function showHeader(forceScrolledClass = false) {
    headerEl.style.top = '0';
    headerEl.style.opacity = '1';
    headerEl.style.pointerEvents = 'auto';
    hidden = false;
    if (forceScrolledClass) headerEl.classList.add('scrolled');
  }

  function hideHeader() {
    headerEl.style.top = '-90px';
    headerEl.style.opacity = '0';
    headerEl.style.pointerEvents = 'none';
    hidden = true;
  }

  function updateScrolledClassOnScroll(y) {
    if (y > 0) headerEl.classList.add('scrolled');
    else headerEl.classList.remove('scrolled');
  }

  function handleScroll() {
    const y = window.scrollY || 0;
    const menuOpen = isMenuOpen();
    const threshold = Math.max(50, heroHeight - 80);

    updateScrolledClassOnScroll(y);

    if (menuOpen) {
      showHeader(true);
      lastY = y;
      return;
    }

    if (y > threshold) {
      if (y > lastY && !hidden) hideHeader();
      else if (y < lastY && hidden) showHeader(true);
    } else {
      if (y === 0) headerEl.classList.remove('scrolled');
      showHeader(false);
    }

    lastY = y;
  }

  // Hover reveal (only when menu is closed)
  document.addEventListener('mousemove', (e) => {
    if (isMenuOpen()) return;
    if (e.clientY < 100) {
      if (hidden) {
        showHeader(true);
        hoverShown = true;
      }
    } else if (hoverShown) {
      setTimeout(() => {
        if (window.scrollY > Math.max(50, heroHeight - 80) && !isMenuOpen()) hideHeader();
        hoverShown = false;
      }, 220);
    }
  }, { passive: true });
  

  /* === FIXED HAMBURGER MENU BEHAVIOR === */
  if (hamburger && headerRight) {
    hamburger.addEventListener('click', () => {
      const isNowOpen = hamburger.classList.toggle('open');
      headerRight.classList.toggle('open', isNowOpen);

      if (isNowOpen) {
        // Show header fully and keep dark so dropdown is readable
        showHeader(true);
        headerEl.classList.add('scrolled');
      } else {
        handleScroll();
      }
    });
  }

  window.addEventListener('resize', () => {
    heroHeight = Math.round(heroEl.getBoundingClientRect().height);
    handleScroll();
  }, { passive: true });

  window.addEventListener('scroll', handleScroll, { passive: true });

  window.addEventListener('load', () => {
    heroHeight = Math.round(heroEl.getBoundingClientRect().height);
    updateScrolledClassOnScroll(window.scrollY || 0);
    handleScroll();
  });
})();

/* === SMOOTH SCROLL === */
document.querySelectorAll('.header-right a').forEach(link => {
  link.addEventListener('click', e => {
    const href = link.getAttribute('href');
    if (href && href.startsWith('#')) {
      e.preventDefault();
      const target = document.getElementById(href.slice(1));
      if (target) {
        window.scrollTo({ top: target.offsetTop - 80, behavior: 'smooth' });
      }
      headerRight.classList.remove('open');
      hamburger.classList.remove('open');
    }
  });
});

    
(function() {
  const applyHeroPeek = () => {
    const heroes = document.querySelectorAll('.hero');
    heroes.forEach(hero => {
      if (hero.querySelector('.hero-peek')) return;

      const peek = document.createElement('div');
      peek.className = 'hero-peek';

      // Determine hero brightness (basic)
      const bg = window.getComputedStyle(hero).backgroundColor;
      let darkHero = true;
      if (bg.startsWith('rgb')) {
        const rgb = bg.match(/\d+/g).map(Number);
        const brightness = (rgb[0]*299 + rgb[1]*587 + rgb[2]*114) / 1000;
        darkHero = brightness < 128; // simple threshold
      }

      peek.dataset.theme = darkHero ? 'dark' : 'light';
      hero.appendChild(peek);
    });
  };

  window.addEventListener('load', applyHeroPeek);
  window.addEventListener('resize', applyHeroPeek);
})();
</script>
  
</body>
</html>
