<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Track Order - Sérac</title>

  <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@300;400;500&family=Playfair+Display:wght@400;700&display=swap" rel="stylesheet" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" />
<style>
/* ================= RESET & BASE ================= */
* { margin:0; padding:0; box-sizing:border-box; }
html, body { font-family:"Montserrat", sans-serif; color:#F5F5F3; background:#141517; scroll-behavior:smooth; }
a { text-decoration:none; color: inherit; transition: color 0.3s ease; }
a:hover { color:#B66E41; }

/* ================= HEADER ================= */
.site-header {
  position: fixed;
  top:0; left:0; right:0;
  display:flex;
  justify-content:space-between;
  align-items:center;
  padding:16px 28px;
  background: transparent;
  border-bottom:1px solid rgba(245,245,243,0.1);
  transition: background 0.4s ease, box-shadow 0.4s ease;
  z-index:1200;
}
.site-header.scrolled { background: rgba(20,21,23,0.95); box-shadow:0 4px 20px rgba(0,0,0,0.6); }

.header-left { display:flex; align-items:center; gap:14px; }
.brand-logo { height:56px; width:auto; object-fit:contain; filter: drop-shadow(0 4px 12px rgba(0,0,0,0.6)); }
.brand-title { font-family:"Playfair Display", serif; font-size:22px; font-weight:700; color: #B66E41;; letter-spacing:0.6px; }


.header-right {
  display:flex;
  gap:28px;
  font-weight:500;
}
.header-right a {
  position: relative;
  color: #F5F5F3;
  padding: 6px 0;
  font-size: 1rem;
}
.header-right a::after {
  content:"";
  position:absolute;
  bottom:-4px;
  left:0;
  width:0;
  height:2px;
  background:#B66E41;
  transition: width 0.3s ease;
}
.header-right a:hover {
  color: #B66E41;;
}
.header-right a:hover::after { width:100%; }

/* ================= HAMBURGER ================= */
/* Hamburger */
.hamburger { all: unset; display:none; background:none; border:none; cursor:pointer; width:30px !important; height:24px !important; position:relative; }
.hamburger span { display:block; width:100%; height:3px !important; background:#B66E41; border-radius:2px; position:absolute; left:0; transition:0.3s; }
.hamburger span:nth-child(1){ top:0; }
.hamburger span:nth-child(2){ top:10px; }
.hamburger span:nth-child(3){ top:20px; }
.hamburger.open span:nth-child(1){ transform:rotate(45deg); top:10px; background:#B66E41; }
.hamburger.open span:nth-child(2){ opacity:0; }
.hamburger.open span:nth-child(3){ transform:rotate(-45deg); top:10px; background:#B66E41; }

    
.track-section {min-height:100vh;display:flex;justify-content:center;align-items:center;padding:120px 20px;}
.track-box {max-width:960px;width:100%;background:#1c1e22;padding:60px;border-radius:16px;box-shadow:0 12px 40px rgba(0,0,0,0.6);color:#ddd;text-align:center;display:flex;flex-direction:column;align-items:center;}
.track-box h1 {font-family:"Playfair Display",serif;color:#B66E41;margin-bottom:12px;font-size:2rem;}
.track-box p {color:#ccc;margin-bottom:24px;font-size:15px;}
input {background:#17181b;border:1px solid rgba(255,255,255,0.06);border-radius:10px;padding:12px 14px;color:#fff;font-size:15px;width:100%;max-width:400px;transition:border-color .25s ease;margin-bottom:18px;}
input:focus {outline:none;border-color:#B66E41;}
button {background:#B66E41;color:#fff;border:none;border-radius:8px;padding:12px 26px;font-weight:600;cursor:pointer;transition:transform .25s, box-shadow .25s;}
button:hover {transform:translateY(-3px);box-shadow:0 12px 36px rgba(182,110,65,0.25);}
.order-status {margin-top:40px;width:100%;display:none;text-align:left;background:#17181b;padding:30px;border-radius:12px;border:1px solid rgba(255,255,255,0.05);}
.order-status h3 {color:#B66E41;font-family:"Playfair Display",serif;text-align:center;margin-bottom:18px;}
.order-details {list-style:none;padding:0;}
.order-details li {padding:10px 0;border-bottom:1px solid rgba(255,255,255,0.05);color:#eee;}
.order-details strong {color:#B66E41;display:block;margin-bottom:4px;}
footer{padding:28px;text-align:center;color:#777;margin-top:60px}
#serac-overlay{position:fixed;inset:0;z-index:9999;display:flex;align-items:center;justify-content:center;background:rgba(0,0,0,0.95);backdrop-filter:blur(6px);transition:opacity .45s ease;opacity:0;pointer-events:none;}
#serac-overlay.active{opacity:1;pointer-events:auto;}
.gold-spinner{width:64px;height:64px;border-radius:50%;border:5px solid rgba(182,110,65,0.18);border-top-color:#B66E41;animation:serac-spin 1s linear infinite;box-shadow:0 6px 26px rgba(0,0,0,0.6);}
@keyframes serac-spin{to{transform:rotate(360deg)}}

/* Chat-style floating support button */
#floatingSupportBtn {
  position: fixed;
  bottom: 25px;
  right: 25px;
  width: 56px;
  height: 56px;
  background: #1a202b; /* Sérac primary color */
  color: #fff;
  border: none;
  border-radius: 50%;
  cursor: pointer;
  font-size: 24px;
  display: flex;
  align-items: center;
  justify-content: center;
  box-shadow: 0 6px 20px rgba(182, 110, 65, 1);
  transition: all 0.3s ease;
  z-index: 9999;
}

#floatingSupportBtn:hover {
  background: #20232b;
  transform: translateY(-2px);
  box-shadow: 0 8px 24px rgba(75, 78, 84, 1.0);
}

/* Tooltip */
.support-tooltip {
  position: absolute;
  bottom: 50px;      /* tooltip above button */
  left: 20%;
  transform: translateX(-50%);
  background: #1c1e22;
  color: #fff;
  padding: 6px 12px;
  border-radius: 8px;
  font-size: 14px;
  white-space: nowrap;
  opacity: 0;
  pointer-events: none;
  transition: opacity 0.3s ease, transform 0.3s ease;
}

#floatingSupportBtn:hover .support-tooltip {
  opacity: 1;
  transform: translateX(-50%) translateY(-6px);
}

/* ================= FOOTER ================= */
footer {
  text-align:center;
  padding:28px;
  background:#141517;
  color:#aaa;
  margin-top:60px;
}
footer p { font-size:14px; }

/* ================= RESPONSIVE ================= */
@media(max-width:900px){
  section.story .container { grid-template-columns:1fr; gap:30px; }
  .contact-flex { flex-direction:column; }
}

@media(max-width:900px){
  .header-right { display:none; flex-direction:column; background:rgba(20,21,23,0.98); position:absolute; top:70px; right:0; width:220px; padding:18px; border-radius:8px; z-index:1100; }
  .header-right.open { display:flex; }
  .hamburger { display:block; }
</style>
    
</head>

<body>
  <div id="serac-overlay" aria-hidden="true">
    <div class="gold-spinner"></div>
  </div>

  <header class="site-header" id="siteHeader">
    <div class="header-left">
      <img src="asset/logo.png" alt="Sérac" class="brand-logo" />
      <div class="brand-title">Sérac</div>
    </div>

    <nav class="header-right" id="headerRight">
      <a href="index.html">Home</a>
      <a href="shop.html">Shop</a>
      <a href="about.html">About</a>
      <a href="contact.html">Contact</a>
      <a href="trackorder.html">Track</a>
    </nav>

    <button class="hamburger" id="hamburger" aria-label="Menu" aria-expanded="false">
      <span></span><span></span><span></span>
    </button>
  </header>

  <section class="track-section">
    <div class="track-box">
      <h1>Track Your Order</h1>
      <p>Enter your Order Reference Number below to check the status of your order.</p>

      <form id="trackOrderForm">
        <input type="text" id="orderRef" placeholder="Enter your order reference" required>
        <button type="submit">Check Status</button>
      </form>

      <div class="order-status" id="orderStatus">
        <h3>Order Details</h3>
        <ul class="order-details" id="orderDetails"></ul>
      </div>
    </div>
  </section>

  <!-- Floating Chat-Style Support Button -->
  <button id="floatingSupportBtn" aria-label="Contact Support">
    <i class="fas fa-headset"></i>
    <span class="support-tooltip">Support</span>
  </button>

  <footer>
    © <span id="year"></span> Sérac. All rights reserved.
  </footer>

  <script>

 // ✅ Fix: Hamburger toggle logic
    if (hamburger && headerRight) {
      hamburger.addEventListener('click', () => {
        hamburger.classList.toggle('open');
        headerRight.classList.toggle('open');
        const expanded = hamburger.classList.contains('open');
        hamburger.setAttribute('aria-expanded', expanded);
      });
    }
    
//* -------------------- HEADER/HERO BEHAVIOR (Final Unified Version for All Pages) -------------------- */
(function headerHeroBehavior(){
  const headerEl = document.querySelector('.site-header') || document.getElementById('siteHeader');
  const heroEl =
    document.querySelector('.hero') ||
    document.getElementById('heroSection') ||
    document.querySelector('.hero-about');
  const hamburger = document.getElementById('hamburger');
  const headerRight = document.querySelector('.header-right');

  if(!headerEl || !heroEl) return;

  let lastY = window.scrollY || 0;
  let hidden = false;
  let hoverShown = false;
  let heroHeight = Math.round(heroEl.getBoundingClientRect().height);

  // Hamburger toggle
  if(hamburger && headerRight){
    hamburger.addEventListener('click', ()=>{
      headerRight.classList.toggle('open');
      hamburger.classList.toggle('open');
      setTimeout(handleScroll, 150);
    });
  }

  function isMenuOpen(){
    return hamburger && hamburger.classList.contains('open');
  }

  function showHeader(){
    headerEl.style.top = '0';
    headerEl.style.opacity = '1';
    headerEl.style.pointerEvents = 'auto';
    hidden = false;
  }

  function hideHeader(){
    headerEl.style.top = '-90px';
    headerEl.style.opacity = '0';
    headerEl.style.pointerEvents = 'none';
    hidden = true;
  }

  function handleScroll(){
    const y = window.scrollY || 0;
    const menuOpen = isMenuOpen();
    const isMobile = window.innerWidth <= 768;

    // Header background rule
    if(isMobile){
      // On mobile → dark after minimal scroll
      if(y > 10) headerEl.classList.add('scrolled');
      else headerEl.classList.remove('scrolled');
    } else {
      // On desktop → dark only after hero
      if(y > Math.max(50, heroHeight - 80)) headerEl.classList.add('scrolled');
      else headerEl.classList.remove('scrolled');
    }

    // Keep visible when menu is open
    if(menuOpen){
      showHeader();
      return;
    }

    // Hide/show behavior for desktop
    if(!isMobile && y > heroHeight - 80){
      if(y > lastY && !hidden){
        hideHeader();
      } else if(y < lastY && hidden){
        showHeader();
        headerEl.classList.add('scrolled');
      }
    } else {
      showHeader();
      if(!isMobile) headerEl.classList.remove('scrolled');
    }

    lastY = y;
  }

  // Hover near top (disabled if menu open or on mobile)
  document.addEventListener('mousemove', (e)=>{
    const isMobile = window.innerWidth <= 768;
    if(isMenuOpen() || isMobile) return;

    if(e.clientY < 100){
      if(hidden){
        showHeader();
        headerEl.classList.add('scrolled');
        hoverShown = true;
      }
    } else if(hoverShown){
      setTimeout(()=>{
        if(window.scrollY > heroHeight - 80 && !isMenuOpen()){
          hideHeader();
        }
        hoverShown = false;
      }, 250);
    }
  });

  window.addEventListener('resize', ()=>{
    heroHeight = Math.round(heroEl.getBoundingClientRect().height);
    handleScroll();
  }, { passive: true });

  window.addEventListener('scroll', handleScroll, { passive: true });
  window.addEventListener('load', ()=>{
    heroHeight = Math.round(heroEl.getBoundingClientRect().height);
    handleScroll();
  });
})();

    
// ----------------- Order Tracking -----------------
const form = document.getElementById('trackOrderForm');
const statusBox = document.getElementById('orderStatus');
const detailsList = document.getElementById('orderDetails');
const overlay = document.getElementById('serac-overlay');

function showSpinner(show) {
  overlay.style.display = show ? 'flex' : 'none';
}

form.addEventListener('submit', async (e) => {
  e.preventDefault();
  const ref = document.getElementById('orderRef').value.trim();
  if (!ref) return alert('Please enter your order reference.');

  showSpinner(true);
  detailsList.innerHTML = '';
  statusBox.style.display = 'none';

  try {
    const res = await fetch(`../api/serac/getOrder?trackingRef=${encodeURIComponent(ref)}`);
    const data = await res.json();
    showSpinner(false);

    if (!res.ok || !data.order) {
      statusBox.style.display = 'block';
      detailsList.innerHTML = '<li><strong>Notice:</strong> No order found for that reference.</li>';
      return;
    }

    const doc = data.order;
    const currentStatus = doc.status || 'Paid';

    let statusDate = new Date();
    if (doc.createdAt) {
      if (doc.createdAt.seconds) statusDate = new Date(doc.createdAt.seconds * 1000);
      else statusDate = new Date(doc.createdAt);
    }

    if (Array.isArray(doc.statusHistory) && doc.statusHistory.length > 0) {
      const historyEntry = [...doc.statusHistory].reverse().find(h => h.status === currentStatus && h.changedAt);
      if (historyEntry) {
        const t = historyEntry.changedAt;
        if (t.seconds) statusDate = new Date(t.seconds * 1000);
        else statusDate = new Date(t);
      }
    }

    const amount = doc.total ? `${doc.currency || '₦'}${doc.total.toLocaleString()}` : '—';

    const items = (doc.items || []).map(item => {
      const qty = item.quantity || item.totalQuantity || '—';
      return `${item.name} (${qty})`;
    }).join('<br>') || '—';

    const statusColors = {
      Paid: "#2A9D8F",
      Pending: "#F4A261",
      Processing: "#8A4D2B",
      Shipped: "#C2855E",
      Completed: "#2ECC71",
      Cancelled: "#E74C3C"
    };

    detailsList.innerHTML = `
      <li><strong>Status:</strong> 
        <span style="color:#fff; font-weight:600; position:relative; padding-left:16px;">
          <span style="width:10px; height:10px; background:${statusColors[currentStatus] || '#999'}; border-radius:50%; position:absolute; left:0; top:50%; transform:translateY(-50%); display:inline-block;"></span>
          ${currentStatus}
        </span>
      </li>
      <li><strong>Date:</strong> ${statusDate.toLocaleString()}</li>
      <li><strong>Amount:</strong> ${amount}</li>
      <li><strong>Items:</strong><br>${items}</li>
    `;
    statusBox.style.display = 'block';
  } 
  catch (err) {
    console.error(err);
    showSpinner(false);
    detailsList.innerHTML = '<li><strong>Error:</strong> Unable to fetch order details. Try again later.</li>';
    statusBox.style.display = 'block';
  }
});

// ----------------- Support Button -----------------
const supportBtn = document.getElementById('floatingSupportBtn');
supportBtn.addEventListener('click', () => {
  window.location.href = 'mailto:stonecold.serac@gmail.com?subject=Support%20Request';
});

// ----------------- Footer Year -----------------
document.getElementById('year').textContent = new Date().getFullYear();
</script>

<script>
(function() {
  const applyHeroPeek = () => {
    const heroes = document.querySelectorAll('.hero');
    heroes.forEach(hero => {
      if (hero.querySelector('.hero-peek')) return;

      const peek = document.createElement('div');
      peek.className = 'hero-peek';

      // Determine hero brightness (basic)
      const bg = window.getComputedStyle(hero).backgroundColor;
      let darkHero = true;
      if (bg.startsWith('rgb')) {
        const rgb = bg.match(/\d+/g).map(Number);
        const brightness = (rgb[0]*299 + rgb[1]*587 + rgb[2]*114) / 1000;
        darkHero = brightness < 128; // simple threshold
      }

      peek.dataset.theme = darkHero ? 'dark' : 'light';
      hero.appendChild(peek);
    });
  };

  window.addEventListener('load', applyHeroPeek);
  window.addEventListener('resize', applyHeroPeek);
})();
</script>
  
</body>
</html>
