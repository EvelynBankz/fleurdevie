<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Track Order - Fleur De Vie</title>

<link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@300;400;500&family=Playfair+Display:wght@400;700&display=swap" rel="stylesheet" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" />

<style>
  /* RESET & BASE */
    * { margin:0; padding:0; box-sizing:border-box; }
    body { font-family: "Montserrat", sans-serif; background: #F5E6CC; color:#112e1f; line-height:1.6; }
    a { text-decoration:none; color:inherit; }
    
    /* HEADER (Luxury Translucent Version) */
    .site-header {
      background: rgba(17,46,31,0.9); /* deep brand green, slightly see-through */
      backdrop-filter: blur(2px);
      -webkit-backdrop-filter: blur(5px);
      color: #F5E6CC;
      display:flex;
      justify-content:space-between;
      align-items:center;
      padding:10px 24px;
      position:fixed;
      top:0; left:0; right:0;
      z-index:1000;
      height:68px;
      transition: background 0.3s ease, top 0.4s ease, opacity 0.4s ease;
    }
    
    .site-header.scrolled {
      background: #112e1f; /* solid brand color after scroll */
    }
    
    .site-header.hidden {
      opacity: 0;
      top: -80px;
      pointer-events: none;
    }
    
    .site-header:hover {
      background: rgba(17,46,31,0.9);
    }
    
    .header-left { display:flex; align-items:center; gap:10px; }
    .brand-logo { height:70px; transition:height 0.3s ease; }
    .brand-title { font-family:"Playfair Display", serif; font-size:22px; font-weight:700; }
    
    .header-right { display:flex; gap:20px; align-items:center; }
    
    .header-right a {
      font-weight: 500;
      color: inherit;
      position: relative;
      transition: color 0.3s ease, transform 0.3s ease;
    }
    
    .header-right a:hover {
      color: #c9e4ff;
      transform: translateY(-2px);
    }
  
    
    .hamburger { all: unset; display:none; background:none; border:none; cursor:pointer; width:30px !important; height:24px !important; position:relative; }
    .hamburger span { display:block; width:100%; height:3px !important; background:#F5E6CC; border-radius:2px; position:absolute; left:0; transition:0.3s; }
    .hamburger span:nth-child(1){ top:0; }
    .hamburger span:nth-child(2){ top:10px; }
    .hamburger span:nth-child(3){ top:20px; }
    .hamburger.open span:nth-child(1){ transform:rotate(45deg); top:10px; }
    .hamburger.open span:nth-child(2){ opacity:0; }
    .hamburger.open span:nth-child(3){ transform:rotate(-45deg); top:10px; }


    
@media (max-width:900px) {
  .header-right {
    position: absolute;
    top: 68px;
    right: 0;
    background: rgba(17,46,31,0.95);
    flex-direction: column;
    width: 200px;
    padding: 20px;
    display: none;
    border-radius: 0 0 0 10px;
    z-index: 1100;
  }

  .header-right.open {
    display: flex !important;
    flex-direction: column;
    gap: 12px;
  }

  .hamburger {
    display: block;
  }
}


  .brand-logo{height:clamp(40px,15vw,80px)}
  .brand-title{font-size:clamp(16px,7vw,22px)}
  
  /* --- TRACK SECTION --- */
  .track-section{flex:1; display:flex;justify-content:center;align-items:center;padding:120px 20px;}
  .track-box{max-width:960px;width:100%;background:#FFD6BA;padding:60px;border-radius:16px;box-shadow:0 12px 40px rgba(0,0,0,0.15);color:#112e1f;text-align:center;display:flex;flex-direction:column;align-items:center}
  .track-box h1{font-family:"Playfair Display",serif;margin-bottom:12px;font-size:2rem}
  .track-box p{margin-bottom:24px;font-size:15px;color:#112e1f}
  input{background:#fff;border:1px solid rgba(17,46,31,0.2);border-radius:10px;padding:12px 14px;color:#112e1f;font-size:15px;width:100%;max-width:400px;margin-bottom:18px;transition:border-color .25s ease}
  input:focus{outline:none;border-color:#112e1f}
  button{background:#112e1f;color:#FFD6BA;border:none;border-radius:8px;padding:12px 26px;font-weight:600;cursor:pointer;transition:transform .25s, box-shadow .25s}
  button:hover{transform:translateY(-3px);box-shadow:0 12px 36px rgba(17,46,31,0.25)}

  .order-status{margin-top:40px;width:100%;display:none;text-align:left;background:#c9e4ff;padding:30px;border-radius:12px;border:1px solid rgba(17,46,31,0.2); position:relative;}
  .order-status h3{font-family:"Playfair Display",serif;text-align:center;margin-bottom:18px;color:#112e1f}
  .order-details{list-style:none;padding:0;color:#112e1f}
  .order-details li{padding:10px 0;border-bottom:1px solid rgba(17,46,31,0.1)}
  .order-details strong{display:block;margin-bottom:4px}

  /* Close button for order card */
  .close-order{position:absolute;top:12px;right:12px;font-size:20px;color:#112e1f;cursor:pointer;}

  /* --- Floating Support Button --- */
  #floatingSupportBtn{position:fixed;bottom:25px;right:25px;width:64px;height:64px;border-radius:50%;border:none;background:#112e1f;color:#FFD6BA;display:flex;align-items:center;justify-content:center;font-size:28px;cursor:pointer;box-shadow:0 8px 30px rgba(212,245,105,1);transition:all .3s ease;z-index:10001}
  #floatingSupportBtn:hover{transform:translateY(-2px);box-shadow:0 12px 36px rgba(17,46,31,1)}
  .support-tooltip{position:absolute;bottom:70px;left:50%;transform:translateX(-50%);background:#112e1f;color:#FFD6BA;padding:6px 12px;border-radius:8px;font-size:14px;white-space:nowrap;opacity:0;pointer-events:none;transition:opacity .3s,transform .3s}
  #floatingSupportBtn:hover .support-tooltip{opacity:1;transform:translateX(-50%) translateY(-6px)}

  /* FOOTER */
  footer { text-align:center; padding:20px; background:transparent; color:#112e1f; margin-top:60px; }

 
</style>
</head>

<body>
<header class="site-header">
  <div class="header-left">
    <img src="asset/logo.png" alt="Fleur De Vie Logo" class="brand-logo">
    <div class="brand-title">Fleur De Vie</div>
  </div>
  <!-- Hamburger -->
  <button class="hamburger" id="hamburger-btn">
    <span></span><span></span><span></span>
  </button>
  <nav class="header-right" id="nav-menu">
    <a href="index.html">Home</a>
    <a href="shop.html">Shop</a>
    <a href="about.html">About</a>
    <a href="contact.html">Contact</a>
    <a href="trackorder.html">Track</a>
  </nav>
</header>

<section class="track-section">
  <div class="track-box">
    <h1>Track Your Order</h1>
    <p>Enter your Order Reference Number below to check the status of your order.</p>

    <form id="trackOrderForm">
      <input type="text" id="orderRef" placeholder="Enter your order reference" required>
      <button type="submit">Check Status</button>
    </form>

    <div class="order-status" id="orderStatus">
      <span class="close-order" id="closeOrder">&times;</span>
      <h3>Order Details</h3>
      <ul class="order-details" id="orderDetails"></ul>
    </div>
  </div>
</section>

<button id="floatingSupportBtn">
  <i class="fas fa-headset"></i>
  <span class="support-tooltip">Support</span>
</button>

<footer>© <span id="year"></span> Fleur De Vie</footer>

<script>
  // --- Hamburger ---
   const hamburgerBtn = document.getElementById('hamburger-btn');
   const navMenu = document.getElementById('nav-menu');
   if(hamburgerBtn) hamburgerBtn.addEventListener('click', ()=>{ hamburgerBtn.classList.toggle('open'); if(navMenu) navMenu.classList.toggle('open'); });

  // --- Footer Year ---
  document.getElementById('year').textContent=new Date().getFullYear()

  // --- Order Tracking ---
  const form=document.getElementById('trackOrderForm')
  const statusBox=document.getElementById('orderStatus')
  const detailsList=document.getElementById('orderDetails')
  const orderInput=document.getElementById('orderRef')
  const closeOrder=document.getElementById('closeOrder')

  closeOrder.addEventListener('click',()=>{
    statusBox.style.display='none'
    detailsList.innerHTML=''
    orderInput.value=''
    orderInput.focus()
  })

  form.addEventListener('submit',async e=>{
    e.preventDefault()
    const ref=orderInput.value.trim()
    if(!ref) return alert('Please enter your order reference.')

    // Reset UI before fetch
    statusBox.style.display='none'
    detailsList.innerHTML=''

    try{
      const res = await fetch(`../api/fleurdevie/getOrder?trackingRef=${encodeURIComponent(ref)}`);
      const data=await res.json()

      if(!res.ok || !data.found){
        statusBox.style.display='block'
        detailsList.innerHTML='<li><strong>Notice:</strong> No order found for that reference.</li>'
        return
      }

      const doc=data.order
      const currentStatus=doc.status||'Paid'
      let statusDate=new Date()
      if(doc.createdAt) statusDate=new Date(doc.createdAt)
      if(Array.isArray(doc.statusHistory)&&doc.statusHistory.length>0){
        const historyEntry=[...doc.statusHistory].reverse().find(h=>h.status===currentStatus && h.changedAt)
        if(historyEntry) statusDate=new Date(historyEntry.changedAt)
      }

      const amount=doc.total ? `${doc.currency||'NGN'}${doc.total.toLocaleString()}` : '—'
      const items=(doc.items||[]).map(i=>`${i.name} (${i.quantity||1})`).join('<br>')||'—'
      const statusColors={Paid:"#2A9D8F",Pending:"#F4A261",Processing:"#2A4D2B",Shipped:"#C2855E",Completed:"#2ECC71",Cancelled:"#E74C3C"}

      detailsList.innerHTML=`
        <li><strong>Status:</strong> 
          <span style="color:#112e1f;font-weight:600;position:relative;padding-left:16px;">
            <span style="width:10px;height:10px;background:${statusColors[currentStatus]||'#999'};border-radius:50%;position:absolute;left:0;top:50%;transform:translateY(-50%);display:inline-block;"></span>
            ${currentStatus}
          </span>
        </li>
        <li><strong>Date:</strong> ${statusDate.toLocaleString()}</li>
        <li><strong>Amount:</strong> ${amount}</li>
        <li><strong>Items:</strong><br>${items}</li>
      `
      statusBox.style.display='block'

    }catch(err){
      console.error(err)
      statusBox.style.display='block'
      detailsList.innerHTML='<li><strong>Error:</strong> Unable to fetch order details. Try again later.</li>'
    }
  })

  // --- Support Button ---
  const supportBtn=document.getElementById('floatingSupportBtn')
  supportBtn.addEventListener('click',()=>{window.location.href='mailto:yourstruly.fleurdevie@gmail.com?subject=Support%20Request'})


/* ---- Header Hide/Show (No Hero Version) ---- */
const header = document.querySelector('.site-header');
if (header) {
  let lastScrollY = window.scrollY;
  let isHidden = false;

  function handleScroll() {
    const nowY = window.scrollY;

    if (nowY > 80) { // start after a little scroll
      if (nowY > lastScrollY && !isHidden) {
        header.classList.add('hidden');
        isHidden = true;
      } else if (nowY < lastScrollY && isHidden) {
        header.classList.remove('hidden');
        header.classList.add('scrolled');
        isHidden = false;
      }
    } else {
      header.classList.remove('hidden', 'scrolled');
      isHidden = false;
    }

    lastScrollY = nowY;
  }

  window.addEventListener('scroll', handleScroll, { passive: true });

  // Show header when hovering near top
  document.addEventListener('mousemove', e => {
    if (e.clientY < 100 && isHidden) {
      header.classList.remove('hidden');
      header.classList.add('scrolled');
      isHidden = false;
    }
  });
}

</script>
</body>
</html>
